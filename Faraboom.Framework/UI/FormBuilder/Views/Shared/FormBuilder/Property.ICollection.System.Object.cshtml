
@using System
@using System.Collections.Generic
@using Faraboom.Framework.UI.FormBuilder
@using System.Reflection
@model PropertyViewModel
@{
    var templateType = Model.Type.GetTypeInfo().GenericTypeArguments[0];

    <div class="fb-collection">

        <ul>
            @{
                if (Model.Value != null)
                {
                    foreach (var obj in (IEnumerable<object>)Model.Value)
                    {
                        var id = Guid.NewGuid().ToString();

                        <li draggable="true" id="listitem-@id">
                            <input type="hidden" name="@(Model.Name).Index" value="@id" />
                            @{
                                var prop = FB.PropertyViewModel(obj.GetType(), Model.Name + "[" + id + "]", obj);
                            }
                            @Html.BestProperty(prop)
                            <a class="btn btn-sm fb-move-up btn-default" href="#moveup" title="Move Up"><span class="glyphicon glyphicon-arrow-up"></span></a>
                            <a class="btn btn-sm fb-move-down btn-default" href="#moveup" title="Move Down">
                                <i class="glyphicon glyphicon-arrow-down">
                                </i>
                            </a> <a class="btn btn-mini fb-remove-parent btn-danger btn-sm" href="#remove" title="Remove">
                                <span class="glyphicon glyphicon-remove"></span>
                            </a>
                        </li>
                    }
                }
            }
            <li class="fb-not-collection-item">
                <a class="btn btn-mini btn-primary fb-add-item" href="#add" data-modelname="@Model.Name" title="Add">
                    <span class="glyphicon glyphicon-plus"></span>
                </a>
                <div class="new-fb-collection-outer-container" style="display: none">
                    @(@"<div class=""fb-collection-new-item fb-form"" style=""display: none"">
                                    <input type = 'hidden' name='' value='' />" +
                                FB.PropertiesFor(Activator.CreateInstance(templateType), templateType).Render(Html).ToHtmlString() +
                                @"<a class=""btn btn-sm fb-move-up btn-default"" href=""#moveup"" title=""Move Up""><span class=""glyphicon glyphicon-arrow-up""></span></a>
                                    <a class=""btn btn-sm fb-move-down btn-default"" href=""#movedown"" title=""Move Down"">
                                        <i class=""glyphicon glyphicon-arrow-down"">
                                        </i>
                                    </a> <a class=""btn btn-mini fb-remove-parent btn-danger btn-sm"" href=""#remove"" title=""Remove"">
                                        <span class=""glyphicon glyphicon-remove""></span>
                                    </a>
                                </div>")
                </div>
            </li>
        </ul>
    </div>

}
